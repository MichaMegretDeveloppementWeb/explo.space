import{L as i,g as u}from"./map-responsive-config-DdMpAmdA.js";import{c as w}from"./marker-icon-utils-Ct1xqS19.js";let n=0,r=[],p=0,h=0;function x(){const t=document.getElementById("photoGalleryModal"),e=t?.dataset.photos;if(!e){console.warn("No photos data found");return}try{r=JSON.parse(e)}catch(a){console.error("Failed to parse photos data:",a);return}document.addEventListener("keydown",E),t&&(t.addEventListener("touchstart",v,{passive:!0}),t.addEventListener("touchend",I,{passive:!0})),window.openPhotoGallery=M,window.closePhotoGallery=y,window.navigatePhoto=l}function M(t){n=t;const e=document.getElementById("photoGalleryModal");e.classList.remove("hidden"),document.body.style.overflow="hidden",f(!1),setTimeout(()=>{e.style.opacity="1"},10)}function y(){const t=document.getElementById("photoGalleryModal");t.style.opacity="0",setTimeout(()=>{t.classList.add("hidden"),document.body.style.overflow=""},300)}function l(t){t==="next"?n=(n+1)%r.length:t==="prev"&&(n=(n-1+r.length)%r.length),f(!0,t)}function f(t=!0,e=null){const a=r[n],o=document.getElementById("modalPhoto"),c=document.getElementById("photoCounter");if(!a||!o)return;if(t&&e){const g=e==="next"?"-translate-x-20":"translate-x-20";o.style.transform=g,o.style.opacity="0",o.style.transition="transform 0.3s ease, opacity 0.3s ease",setTimeout(()=>{o.src=a.url,o.alt=a.alt_text||`Image ${n+1}`;const b=e==="next"?"translate-x-20":"-translate-x-20";o.style.transform=b,o.style.opacity="0",o.offsetWidth,setTimeout(()=>{o.style.transform="translate-x-0",o.style.opacity="1"},10)},300)}else o.src=a.url,o.alt=a.alt_text||`Image ${n+1}`,o.style.transform="translate-x-0",o.style.opacity="1",o.style.transition="transform 0.3s ease, opacity 0.3s ease";c&&(c.textContent=`${n+1} / ${r.length}`);const d=document.getElementById("prevPhoto"),m=document.getElementById("nextPhoto");d&&m&&(d.style.display="block",m.style.display="block")}function E(t){if(!document.getElementById("photoGalleryModal")?.classList.contains("hidden"))switch(t.key){case"Escape":y();break;case"ArrowLeft":l("prev");break;case"ArrowRight":l("next");break}}function v(t){t.target.closest("button")||(p=t.changedTouches[0].screenX)}function I(t){t.target.closest("button")||(h=t.changedTouches[0].screenX,T())}function T(){const e=p-h;Math.abs(e)<50||(e>0?l("next"):l("prev"))}let s=null;function L(){const t=document.getElementById("placeMap");if(!t){console.warn("Map container not found");return}const e=parseFloat(t.dataset.latitude),a=parseFloat(t.dataset.longitude);if(t.dataset.title,isNaN(e)||isNaN(a)){console.error("Invalid coordinates");return}s=i.map("placeMap",{center:[e,a],zoom:10,zoomControl:!0,scrollWheelZoom:!0,dragging:!0}),P(),i.marker([e,a],{icon:w()}).addTo(s)}function P(){const t={url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a>',subdomains:["a","b","c","d"],maxZoom:19,minZoom:u()},e={url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a>',maxZoom:19,minZoom:u()},a=i.tileLayer(t.url,{attribution:t.attribution,subdomains:t.subdomains,maxZoom:t.maxZoom,minZoom:t.minZoom});a.on("tileerror",()=>{console.warn("CartoDB tiles failed, switching to OSM fallback"),s.removeLayer(a),i.tileLayer(e.url,{attribution:e.attribution,maxZoom:e.maxZoom,minZoom:e.minZoom}).addTo(s)}),a.addTo(s)}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("photoGalleryModal")&&x(),document.getElementById("placeMap")&&L()});
