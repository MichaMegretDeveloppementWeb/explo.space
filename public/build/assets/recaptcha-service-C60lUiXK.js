class e{static instance=null;constructor(){if(e.instance)return e.instance;this.siteKey=null,this.isLoaded=!1,this.loadingPromise=null,e.instance=this}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){return this.isLoaded?(console.log("✅ reCAPTCHA already initialized"),!0):(this.siteKey=document.querySelector('meta[name="recaptcha-site-key"]')?.content,this.siteKey?typeof grecaptcha<"u"&&grecaptcha.ready?(console.log("✅ reCAPTCHA API already loaded"),this.isLoaded=!0,!0):(console.log("⏳ reCAPTCHA API loading..."),!0):(console.error("❌ reCAPTCHA site key not found in meta tag"),!1))}async waitForRecaptcha(){return this.isLoaded&&typeof grecaptcha<"u"?!0:this.loadingPromise?this.loadingPromise:(this.loadingPromise=new Promise((t,i)=>{const o=setTimeout(()=>{i(new Error("reCAPTCHA loading timeout"))},1e4),r=()=>{typeof grecaptcha<"u"&&grecaptcha.ready?(clearTimeout(o),grecaptcha.ready(()=>{this.isLoaded=!0,this.loadingPromise=null,console.log("✅ reCAPTCHA ready"),t(!0)})):setTimeout(r,100)};r()}),this.loadingPromise)}async getToken(t){if(!this.siteKey)throw console.error("❌ reCAPTCHA not initialized"),new Error("reCAPTCHA not initialized");try{await this.waitForRecaptcha();const i=await grecaptcha.execute(this.siteKey,{action:t});return console.log(`✅ reCAPTCHA token obtained for action: ${t}`),i}catch(i){throw console.error("❌ reCAPTCHA execution failed:",i),i}}isConfigured(){return this.siteKey!==null}getSiteKey(){return this.siteKey}}if(typeof window<"u"){const n=e.getInstance();window.recaptcha={getToken:t=>n.getToken(t),isConfigured:()=>n.isConfigured()}}const s=e.getInstance();export{s as R};
